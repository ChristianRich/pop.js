var EventDispatcher=function(){var c={};this.addEventListener=function(b,a){void 0===c[b]&&(c[b]=[]);-1===c[b].indexOf(a)&&c[b].push(a)};this.hasEventListener=function(b){return!c[b]?!1:!!c[b].length};this.removeEventListener=function(b,a){if(this.hasEventListener(b)){var d=c[b].indexOf(a);-1!==d&&c[b].splice(d,1)}};this.dispatchEvent=function(b){var a=c[b.type];if(void 0!==a){b.target=this;for(var d=0,f=a.length;d<f;d++)a[d].call(this,b)}};this.clone=function(b){var a={},d;for(d in b)a[d]=b[d];return a}};var ArrayIterator=function(c){if(!(this instanceof arguments.callee))throw Error("Constructor called as a function.");if(c&&"[object Array]"!==Object.prototype.toString.apply(c))throw new TypeError("ArrayIterator expected data type Array for argument 'data'.");this.data=c||[];this.index=-1};
ArrayIterator.prototype={push:function(c){this.data.push(c)},insertAt:function(c,b){if(b>this.data.length)throw Error("Out of range "+b);this.data[b]=c},unshift:function(c){this.data.unshift(c)},shift:function(){return this.data.shift()},pop:function(){return this.data.pop()},next:function(){return this.hasNext()?this.data[++this.index]:null},previous:function(){return this.hasPrevious()?this.data[--this.index]:null},first:function(){if(this.isNull())return null;this.reset();return this.next()},last:function(){if(this.isNull())return null;
this.index=this.getSize()-1;return this.data[this.index]},peekNext:function(){return this.hasNext()?this.data[this.index+1]:null},peekPrevious:function(){return this.hasPrevious()?this.data[this.index-1]:null},hasNext:function(){return this.isNull()?!1:this.index+1<this.data.length},hasPrevious:function(){return this.isNull()?!1:0<this.index},reset:function(){this.index=-1;return this},getSize:function(){return this.data.length},isNull:function(){return 0===this.data.length},clone:function(){return new ArrayIterator(this.data)},
reverse:function(){if(this.isNull())return null;this.data.reverse();return this},shuffle:function(){if(this.isNull())return null;for(var c=this.data.length,b=c;b--;){var a=parseInt(Math.random()*c),d=this.data[b];this.data[b]=this.data[a];this.data[a]=d}return this},dump:function(){if(this.isNull())return this.toString();for(var c=this.toString()+"\n",b=0;b<this.data.length;b++)c+="\n"+this.data[b];return c},toString:function(){var c="[ArrayIterator]";this.name&&(c+=" name: "+this.name+",");return c+=
" size: "+this.getSize()+", index: "+this.index+", hasNext: "+this.hasNext()+", hasPrevious: "+this.hasPrevious()}};(function(c){var b=function(a){a=a||{};var d,f,g=!1,e=this;b.VERSION="1.0";b.NAME="Pop.js";b.CLASS_VISIBLE=a.classVisible||"visible";b.CLASS_HIDDEN=a.classHidden||"hidden";EventDispatcher.call(this);e.open=function(a,b){e.close();d=h(a,b);d.open()};e.close=function(){d&&(g=!1,d.close(),d=null)};e.add=function(a,b){f||(f=new ArrayIterator);f.push(h(a,b))};e.start=function(){f&&(e.close(),g=!0,f.reset(),d=f.next(),d.open())};e.next=function(){g&&f.hasNext()&&(d.close(),d=f.next(),d.open())};e.previous=
function(){g&&f.hasPrevious()&&(d.close(),d=f.previous(),d.open())};e.first=function(){g&&1!=f.getSize()&&(d.close(),d=f.first(),d.open())};e.last=function(){g&&1!=f.getSize()&&(d.close(),d=f.last(),d.open())};var k=function(a){e.dispatchEvent(e.clone(a))},l=function(a){e.dispatchEvent(e.clone(a))},h=function(a,d){if(!a)throw Error("Too few arguments.");var c=b.getTarget(a),c=new b.Dialogue(c,d||null);c.addEventListener("open",k);c.addEventListener("close",l);return c};c.addEventListener("keydown",
function(a){switch(a.keyCode){case 27:e.close();break;case 38:e.first();break;case 40:e.last();break;case 37:e.previous();break;case 39:e.next()}},!1)};b.addClass=function(a,b){a.classList?a.classList.add(b):(b=b.replace(/(^\s+|\s+$)/g,""),a.className=a.className.replace(/(^\s+|\s+$)/g,""),a.className+=" "+b)};b.removeClass=function(a,b){a.classList?a.classList.remove(b):(a.className=a.className.replace(RegExp("(\\s|^)"+b+"(\\s|$)")," "),a.className=a.className.replace(/(^\s+|\s+$)/g,""))};b.hasClass=
function(a,b){return a.classList?a.classList.contains(b):!!a.className.match(RegExp("(\\s|^)"+b+"(\\s|$)"))};b.getTarget=function(a){if(!a)throw Error(b.NAME+": too few arguments.");var c;"[object String]"===Object.prototype.toString.apply(a)?c=document.querySelector?document.querySelector(a):document.getElementById(a):"nodeType"in a&&(c=a);if(!c)throw Error(b.NAME+": unknown element "+a);return c};c.Pop=b})(window);Pop.Dialogue=function(c,b){EventDispatcher.call(this);this.el=c;this.data=b||null;var a=this;a.open=function(){a.isOpen()||(Pop.removeClass(c,Pop.CLASS_HIDDEN),Pop.addClass(c,Pop.CLASS_VISIBLE),a.dispatchEvent({type:"open",data:a.data,currentTarget:a.el}))};a.close=function(){a.isOpen()&&(Pop.removeClass(c,Pop.CLASS_VISIBLE),Pop.addClass(c,Pop.CLASS_HIDDEN),a.dispatchEvent({type:"close",data:a.data,currentTarget:a.el}))};a.isOpen=function(){return Pop.hasClass(c,Pop.CLASS_VISIBLE)};a.toString=function(){return"[Object Dialogue] "+
c.className}};
